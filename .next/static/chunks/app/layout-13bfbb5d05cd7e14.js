(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{1226:()=>{},1689:(e,s,a)=>{Promise.resolve().then(a.t.bind(a,9324,23)),Promise.resolve().then(a.bind(a,5770)),Promise.resolve().then(a.bind(a,4426)),Promise.resolve().then(a.bind(a,9257)),Promise.resolve().then(a.bind(a,8162)),Promise.resolve().then(a.bind(a,9766)),Promise.resolve().then(a.t.bind(a,4233,23)),Promise.resolve().then(a.t.bind(a,5427,23)),Promise.resolve().then(a.bind(a,5037))},5770:(e,s,a)=>{"use strict";a.d(s,{default:()=>y});var l=a(5155),t=a(8162),n=a(2115),r=a(6822),o=a(4057);let c=(0,o.A)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var i=a(2472);let d=(0,o.A)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var u=a(8173),h=a.n(u),v=a(6046);let y=()=>{let{logout:e,authUser:s,checkAuth:a}=(0,n.useContext)(t.F);return(0,v.useRouter)(),(0,n.useEffect)(()=>{a()},[]),(0,l.jsx)("header",{className:"bg-base-100 border-b border-base-300 fixed w-full top-0 z-40    backdrop-blur-lg bg-base-100/80",children:(0,l.jsx)("div",{className:"container mx-auto px-4 h-16",children:(0,l.jsxs)("div",{className:"flex items-center justify-between h-full",children:[(0,l.jsx)("div",{className:"flex items-center gap-8",children:(0,l.jsxs)(h(),{href:"/",className:"flex items-center gap-2.5 hover:opacity-80 transition-all",children:[(0,l.jsx)("div",{className:"size-9 rounded-lg bg-primary/10 flex items-center justify-center",children:(0,l.jsx)(r.A,{className:"w-5 h-5 text-primary"})}),(0,l.jsx)("h1",{className:"text-lg font-bold",children:"Drogovori"})]})}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)(h(),{href:"/settings",className:"\n              btn btn-sm gap-2 transition-colors\n              \n              ",children:[(0,l.jsx)(c,{className:"w-4 h-4"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Settings"})]}),s&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(h(),{href:"/profile",className:"btn btn-sm gap-2",children:[(0,l.jsx)(i.A,{className:"size-5"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Profile"})]}),(0,l.jsxs)("button",{className:"flex gap-2 items-center",onClick:e,children:[(0,l.jsx)(d,{className:"size-5"}),(0,l.jsx)("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})]})})})}},4426:(e,s,a)=>{"use strict";a.d(s,{default:()=>r});var l=a(5155),t=a(2115),n=a(9766);function r(e){let{children:s}=e,{theme:a}=(0,t.useContext)(n.D);return(0,l.jsx)("div",{"data-theme":a,className:"w-full h-full",children:s})}},9257:(e,s,a)=>{"use strict";a.d(s,{U:()=>c,default:()=>i});var l=a(5155),t=a(2115),n=a(5037),r=a(7595),o=a(8162);let c=(0,t.createContext)(),i=e=>{let{children:s}=e,{socket:a}=(0,t.useContext)(o.F),[i,d]=(0,t.useState)(),[u,h]=(0,t.useState)([]),[v,y]=(0,t.useState)([]),[m,f]=(0,t.useState)(null),[g,b]=(0,t.useState)(!1),[x,p]=(0,t.useState)(!1);console.log(a);let S=(0,t.useCallback)(async()=>{b(!0);try{let e=await r.S.get("/messages/users");y(e.data)}catch(a){var e,s;n.Ay.error((null==a?void 0:null===(s=a.response)||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Failed to fetch users")}finally{b(!1)}},[]),k=(0,t.useCallback)(async e=>{p(!0);try{let s=await r.S.get("/messages/".concat(e));h(s.data)}catch(e){var s,a;n.Ay.error(null==e?void 0:null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)}finally{p(!1)}},[]),N=(0,t.useCallback)(async e=>{console.log(m);try{let s=await r.S.post("/messages/send/".concat(m._id),e);h(e=>[...e,s.data])}catch(e){n.Ay.error("Failed to send message")}},[m]),j=(0,t.useCallback)(()=>{if(!a||!m){console.error("no socket found");return}null==a||a.on("newMessage",e=>{e.senderId!==m._id&&console.log("received msg:",e),h(s=>[...s,e])})},[a,m]),_=(0,t.useCallback)(()=>{null==a||a.off("newMessage")},[a,m]);return(0,l.jsx)(c.Provider,{value:{chat:i,setChat:d,messages:u,setMessages:h,users:v,setUsers:y,selectedUser:m,setSelectedUser:f,isUsersLoading:g,setIsUsersLoading:b,isMessagesLoading:x,setIsMessagesLoading:p,getMessages:k,getUsers:S,sendMessage:N,subscribeToMessages:j,unsubscribeToMessages:_},children:s})}},8162:(e,s,a)=>{"use strict";a.d(s,{F:()=>c,default:()=>i});var l=a(5155),t=a(7595);a(6046),a(5521);var n=a(2115),r=a(5037),o=a(1319);let c=(0,n.createContext)(),i=e=>{let{children:s}=e,[a,i]=(0,n.useState)(null),[d,u]=(0,n.useState)(!1),[h,v]=(0,n.useState)(!1),[y,m]=(0,n.useState)(!1),[f,g]=(0,n.useState)(!0),[b,x]=(0,n.useState)([]),[p,S]=(0,n.useState)(null),k=(0,n.useCallback)(async()=>{if(!(null==a?void 0:a._id)){console.error("No authUser or userId found");return}console.log("Connecting socket for user:",a._id);let e=(0,o.io)("http://localhost:5001",{query:{userId:a._id}});return e.on("connect",()=>{console.log("Socket connected:",e.id)}),e.on("connect_error",e=>{console.error("Socket connection error:",e)}),e.on("getOnlineUsers",e=>{console.log("Online users:",e),x(e)}),console.log(e),S(e),()=>{e.disconnect()}},[a]),N=async()=>{(null==p?void 0:p.connected)&&p.disconnect()},j=(0,n.useCallback)(async()=>{try{let e=await t.S.get("/auth/check");i(e.data)}catch(e){console.error("Auth check failed:",e),i(null)}finally{g(!1)}},[]),_=async e=>{u(!0);try{let s=await t.S.post("/auth/signup",e);i(s.data),console.log(s.data),r.Ay.success("Account created successfully!"),k()}catch(e){r.Ay.error("Signup failed")}finally{u(!1),console.log(a)}},A=async()=>{try{await t.S.post("/auth/logout"),i(null),r.Ay.success("Logged out successfully"),N()}catch(e){r.Ay.error(e.message)}},w=async e=>{v(!0);try{let s=await t.S.post("/auth/login",e);i(s.data),r.Ay.success("Logged in successfully"),k()}catch(e){r.Ay.error("Failed to login")}finally{v(!1)}},C=async e=>{m(!0);try{let s=await t.S.put("/auth/update-profile",e);i(s.data),r.Ay.success("Profile updated succesfully")}catch(e){var s,a;console.log("error in update profile:",e),r.Ay.error(null==e?void 0:null===(a=e.response)||void 0===a?void 0:null===(s=a.data)||void 0===s?void 0:s.message)}finally{m(!1)}};return(0,n.useEffect)(()=>{(null==a?void 0:a._id)?k():N()},[a,k]),(0,l.jsx)(c.Provider,{value:{authUser:a,setAuthUser:i,isSigningUp:d,setIsSigningUp:u,isLoggingIn:h,setIsLoggingIn:v,isUpdatingProfile:y,setIsUpdatingProfile:m,isCheckingAuth:f,setIsCheckingAuth:g,checkAuth:j,signup:_,logout:A,login:w,updateProfile:C,onlineUsers:b,setOnlineUsers:x,connectSocket:k,socket:p,setSocket:S},children:s})}},9766:(e,s,a)=>{"use strict";a.d(s,{D:()=>n,default:()=>r});var l=a(5155),t=a(2115);let n=(0,t.createContext)(),r=e=>{let{children:s}=e,[a,r]=(0,t.useState)(localStorage.getItem("chat-theme")||"light");return(0,l.jsx)(n.Provider,{value:{theme:a,setTheme:r},children:s})}},7595:(e,s,a)=>{"use strict";a.d(s,{S:()=>l});let l=a(2651).A.create({baseURL:"http://localhost:5001/api",withCredentials:!0})},9324:()=>{},4233:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_4d318d",variable:"__variable_4d318d"}},5427:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_ea5f4b",variable:"__variable_ea5f4b"}},2472:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});let l=(0,a(4057).A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[261,150,474,441,517,358],()=>s(1689)),_N_E=e.O()}]);